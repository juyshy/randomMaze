
<script>
 // http://www.physics.buffalo.edu/phy411-506/topic3/topic3-lec1.pdf

var Site = { // object to represent lattice site
     x:0, // x coordinate
     y:0  // y coordinate
};

 
    console.log( " Self-Avoiding Walks on a Square Lattice\n"
        + " ---------------------------------------\n"
        + " Enter number of steps in walk: ");
    var n_steps, n_walks;
 
    n_steps = Number(prompt("Enter number of steps in walk",""));
    console.log( " Enter number of walks to generate: ");
	n_walks = Number(prompt("Enter number of walks to generate:",""));
 

    var walks = 0;
    var failed_walks = 0;
    var r2av = 0;
    var r4av = 0;

    // generate walks
	var maxtries= 0;
    while (walks < n_walks ) {//&& maxtries < 10
		maxtries +=1;
        var sites = []; // set of occupied lattice sites
        var s ={};
        s.x = 0;
        s.y = 0;
        //sites.push(s);
        var walk_failed = false;
        // loop over desired number of steps
        for (var step = 0; step < n_steps; step++) {
            // take a random step
			 //console.log( " step = " + step  );
            var d = Math.random();
            // console.log( " std_rand = " + d  );
			// luodaan uusi satunnainen piste
            if (d < 0.25) ++s.x; // step East
            else if (d < 0.50) ++s.y; // step North
            else if (d < 0.75) --s.x; // step West
            else --s.y; // step South
			  
            // check whether the site is occupied
            var occupied = false;
			// tarkastetaan on ko uusi satunnainen piste jo varattu
            for (var i = 0; i < sites.length; i++) {
/* 				console.log( "\n  s.x " +  s.x);
            console.log( " s.y " + s.y );
			console.log( "\n sites[" + i + "].x " + sites[i].x );
            console.log( "\ sites[" + i + "].y " + sites[i].y ); */
                if (s.x == sites[i].x && s.y == sites[i].y) {
					
                    occupied = true;
					//console.log( " occupied = " + occupied  );
                    break; // jos on niin keskeytetään tarkistussilmukka
                }
            }
            if (occupied) { // jos step ei onnistunut   keskeytetään steps loop
            walk_failed = true;
			//console.log( " walk_failed = " + walk_failed  );
            break;
            }
			//console.log( "sites.push(s); = " + s.x + " " + s.y  );
            sites.push({ x:s.x , y:s.y });
        }
		
		
        if (walk_failed) {
            ++failed_walks;
            continue;
        }
        var r2 = s.x * s.x + s.y * s.y;
        r2av += r2;
        r4av += r2 * r2;
		 //console.log( " step 2 = " + step  );
        ++walks;
            console.log( "sites: ");
      for (var i = 0; i < sites.length; i++) {
            console.log( "\n sites[" + i + "] x, y: " + sites[i].x + ", " + sites[i].y);
 
    } 
    }

    r2av /= n_walks;
    r4av /= n_walks;
    var stdDev = Math.sqrt(r4av - r2av * r2av);
    var totalWalks = n_walks + failed_walks;
    var failedPercent = failed_walks / totalWalks * 100.0;
    console.log( " Mean square distance <r^2> = " + r2av + "\n"
        + " Standard deviation = " + stdDev + "\n"
        + " Percentage failed walks = " + failedPercent
        );

 

</script>